# Order Service

Этот сервис отвечает за создание и управление заказами в системе Birge-Bazar.

## Описание

Сервис является центральным компонентом транзакционного ядра. Он получает данные из `cart-service`, создает постоянный заказ в своей базе данных (PostgreSQL) и в будущем будет инициировать процесс оплаты через `payment-service`.

## Технологии

*   **Java 17**
*   **Spring Boot 3.2.5**
*   **Spring Data JPA**
*   **PostgreSQL & Liquibase**
*   **Spring Cloud OpenFeign**
*   **Spring Security (OAuth2)**
*   **Maven**

## API Endpoints

Все эндпоинты доступны по префиксу `/api/v1/orders` и требуют валидного Bearer Token.

---

### 1. Создать заказ

*   **POST** `/`
*   **Описание:** Создает новый заказ на основе текущей корзины пользователя. После успешного создания заказа корзина очищается.
*   **Тело запроса:**

```json
{
  "shippingAddressId": 1
}
```

*   **Ответ (201 Created):** Созданный объект `OrderDto`.
*   **Ошибки:**
    *   `400 Bad Request`: Если корзина пуста.

---

### 2. Получить историю своих заказов

*   **GET** `/`
*   **Описание:** Возвращает список всех заказов, сделанных текущим пользователем.
*   **Ответ (200 OK):** Массив объектов `OrderDto`.

---

### 3. Получить заказ по ID

*   **GET** `/{id}`
*   **Описание:** Возвращает детальную информацию о конкретном заказе. Пользователь может просматривать только свои заказы.
*   **Ответ (200 OK):** Объект `OrderDto`.
*   **Ошибки:**
    *   `404 Not Found`: Если заказ не найден.
    *   `403 Forbidden`: Если пользователь пытается просмотреть чужой заказ.

## Локальный запуск

1.  **Настройте базу данных:**
    *   Убедитесь, что у вас запущен PostgreSQL.
    *   Создайте базу данных (например, `order_db`).
    *   Настройте подключение в `application.yml`.

2.  **Запустите зависимости:**
    *   Убедитесь, что запущены `config-server`, `discovery-server`, `auth-service` и **`cart-service`**.

3.  **Сборка и запуск:**
    *   Выполните команду Maven для сборки проекта:
        ```bash
        mvn clean install
        ```
    *   Запустите приложение:
        ```bash
        java -jar target/order-service.jar
        ```
