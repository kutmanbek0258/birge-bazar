# Product Service

Этот сервис отвечает за управление продуктами, категориями и брендами в системе Birge-Bazar.

## Описание

Сервис предоставляет REST API для создания, чтения, обновления и удаления (CRUD) продуктов. Публичные эндпоинты позволяют любому пользователю просматривать продукты, в то время как эндпоинты для создания и изменения защищены и доступны только пользователям с ролью `seller`.

## Технологии

*   **Java 17**
*   **Spring Boot 3.2.5**
*   **Spring Cloud**
*   **PostgreSQL**
*   **Liquibase**
*   **Maven**

## API Endpoints

Все эндпоинты доступны по префиксу `/api/v1/products`.

---

### 1. Получить список продуктов

*   **GET** `/`
*   **Описание:** Возвращает постраничный список всех продуктов. Доступен всем.
*   **Параметры запроса:**
    *   `page`: `int` (по умолчанию `0`) - номер страницы.
    *   `size`: `int` (по умолчанию `20`) - количество элементов на странице.
*   **Ответ (200 OK):**

```json
{
  "content": [
    {
      "id": 1,
      "sellerId": "a1b2c3d4-e5f6-7890-1234-567890abcdef",
      "name": "Смартфон Pro X",
      "basePrice": 999.99,
      "status": "ACTIVE",
      "mainImageUrl": "http://example.com/image.png",
      "categoryId": 10,
      "categoryName": "Электроника",
      "brandId": 25,
      "brandName": "TechCorp"
    }
  ],
  "pageable": { ... },
  "totalElements": 1,
  "totalPages": 1
}
```

---

### 2. Получить продукт по ID

*   **GET** `/{id}`
*   **Описание:** Возвращает детальную информацию о продукте по его ID. Доступен всем.
*   **Ответ (200 OK):** Объект `ProductDto`.

---

### 3. Создать продукт

*   **POST** `/`
*   **Описание:** Создает новый продукт. Доступен только для пользователей с `scope` `seller`.
*   **Требует:** `Bearer Token` с `scope=seller`.
*   **Тело запроса:**

```json
{
  "name": "Новый ноутбук",
  "description": "Очень мощный ноутбук для работы.",
  "basePrice": 1500.00,
  "categoryId": 11,
  "brandId": 25,
  "mainImageUrl": "http://example.com/laptop.png"
}
```

*   **Ответ (201 Created):** Созданный объект `ProductDto`.
*   **Ошибки:**
    *   `401 Unauthorized` / `403 Forbidden`: Если токен недействителен или не имеет нужных прав.
    *   `404 Not Found`: Если `categoryId` или `brandId` не существуют.

---

### 4. Обновить продукт

*   **PUT** `/{id}`
*   **Описание:** Обновляет существующий продукт. Доступен только для продавца, который владеет продуктом (логика владения должна быть добавлена).
*   **Требует:** `Bearer Token` с `scope=seller`.
*   **Тело запроса:** `UpdateProductRequest` (аналогично созданию, но все поля опциональны).
*   **Ответ (200 OK):** Обновленный объект `ProductDto`.

---

### 5. Удалить продукт

*   **DELETE** `/{id}`
*   **Описание:** Удаляет продукт. Доступен только для администраторов.
*   **Требует:** `Bearer Token` с `scope=admin`.
*   **Ответ (204 No Content):** Пустой ответ в случае успеха.

## Локальный запуск

1.  **Настройте базу данных:**
    *   Убедитесь, что у вас запущен PostgreSQL.
    *   Создайте базу данных (например, `product_db`) и схему (`products`).
    *   Настройте подключение в `application.yml` или через переменные окружения.

2.  **Запустите зависимости:**
    *   Убедитесь, что запущены `config-server`, `discovery-server` и `auth-service`.

3.  **Сборка и запуск:**
    *   Выполните команду Maven для сборки проекта:
        ```bash
        mvn clean install
        ```
    *   Запустите приложение:
        ```bash
        java -jar target/product-service.jar
        ```
